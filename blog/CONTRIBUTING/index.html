<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/testing2/blog/rss.xml" title="Introduction to Puppeteer Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/testing2/blog/atom.xml" title="Introduction to Puppeteer Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WT3D2HSL72"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-WT3D2HSL72",{})</script>
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"><title data-react-helmet="true">CONTRIBUTING | Introduction to Puppeteer</title><meta data-react-helmet="true" property="og:title" content="CONTRIBUTING | Introduction to Puppeteer"><meta data-react-helmet="true" name="description" content="- How to Contribute"><meta data-react-helmet="true" property="og:description" content="- How to Contribute"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><link data-react-helmet="true" rel="shortcut icon" href="/testing2/img/favicon.ico"><link rel="stylesheet" href="/testing2/styles.3199abc1.css">
<link rel="preload" href="/testing2/styles.1b2702fc.js" as="script">
<link rel="preload" href="/testing2/runtime~main.d62fd070.js" as="script">
<link rel="preload" href="/testing2/main.49fc4005.js" as="script">
<link rel="preload" href="/testing2/1.39323fe6.js" as="script">
<link rel="preload" href="/testing2/2.bd80ada8.js" as="script">
<link rel="preload" href="/testing2/3.4c2ec1ad.js" as="script">
<link rel="preload" href="/testing2/ccc49370.c7adbee1.js" as="script">
<link rel="preload" href="/testing2/704a48b3.b781fd51.js" as="script">
<link rel="preload" href="/testing2/54f148e2.f5344aef.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top navbar--primary navbarHideable_17Wu navbarHidden_19ww"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/testing2/"><img src="/testing2/img/pptr.png" alt="Realtime Apps Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/testing2/img/pptr.png" alt="Realtime Apps Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Puppeteer</strong></a><a class="navbar__item navbar__link" href="/testing2/docs/puppeteer.puppeteer">API</a><a class="navbar__item navbar__link" href="/testing2/docs/contributing">Contribute</a><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a class="navbar__item navbar__link" href="/testing2/docs/puppeteer.puppeteer">5.4.0</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/testing2/docs/next/puppeteer.puppeteer">Next</a></li><li><a class="dropdown__link" href="/testing2/docs/puppeteer.puppeteer">5.4.0</a></li><li><a class="dropdown__link" href="/testing2/docs/6.0.0/puppeteer.puppeteer">6.0.0</a></li><li><a class="dropdown__link" href="/testing2/docs/10.0.0/puppeteer.puppeteer">10.0.0</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/puppeteer/puppeteer" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Github</a><a href="https://stackoverflow.com/questions/tagged/puppeteer" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Stack</a><a href="https://github.com/puppeteer/puppeteer/blob/main/docs/troubleshooting.md" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Version 1.0</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/testing2/"><img src="/testing2/img/pptr.png" alt="Realtime Apps Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/testing2/img/pptr.png" alt="Realtime Apps Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Puppeteer</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/testing2/docs/puppeteer.puppeteer">API</a></li><li class="menu__list-item"><a class="menu__link" href="/testing2/docs/contributing">Contribute</a></li><li class="menu__list-item menu__list-item--collapsed"><a role="button" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/testing2/docs/next/puppeteer.puppeteer">Next</a></li><li class="menu__list-item"><a class="menu__link" href="/testing2/docs/puppeteer.puppeteer">5.4.0</a></li><li class="menu__list-item"><a class="menu__link" href="/testing2/docs/6.0.0/puppeteer.puppeteer">6.0.0</a></li><li class="menu__list-item"><a class="menu__link" href="/testing2/docs/10.0.0/puppeteer.puppeteer">10.0.0</a></li></ul></li><li class="menu__list-item"><a href="https://github.com/puppeteer/puppeteer" target="_blank" rel="noopener noreferrer" class="menu__link">Github</a></li><li class="menu__list-item"><a href="https://stackoverflow.com/questions/tagged/puppeteer" target="_blank" rel="noopener noreferrer" class="menu__link">Stack</a></li><li class="menu__list-item"><a href="https://github.com/puppeteer/puppeteer/blob/main/docs/troubleshooting.md" target="_blank" rel="noopener noreferrer" class="menu__link">Version 1.0</a></li></ul></div></div></div></nav><div class="main-wrapper blog-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--2"><div class="sidebar_SWld thin-scrollbar"><h3 class="sidebarItemTitle_Km2m">Recent posts</h3><ul class="sidebarItemList_3UpA"><li class="sidebarItem_2T0D"><a aria-current="page" class="sidebarItemLink_v5H9 sidebarItemLinkActive_1anX" href="/testing2/blog/CONTRIBUTING">CONTRIBUTING</a></li></ul></div></div><main class="col col--8"><article><header><h1 class="margin-bottom--sm blogPostTitle_3-lP"></h1><div class="margin-vert--md"><time datetime="2021-07-04T07:58:34.122Z" class="blogPostDate_Ta7i">July 4, 2021  · 9 min read</time></div><div class="avatar margin-vert--md"><div class="avatar__intro"></div></div></header><section class="markdown"><ul><li><a href="#how-to-contribute">How to Contribute</a><ul><li><a href="#contributor-license-agreement">Contributor License Agreement</a></li><li><a href="#getting-code">Getting Code</a></li><li><a href="#code-reviews">Code reviews</a></li><li><a href="#code-style">Code Style</a></li><li><a href="#typescript-guidelines">TypeScript guidelines</a></li><li><a href="#project-structure-and-typescript-compilation">Project structure and TypeScript compilation</a><ul><li><a href="#shipping-cjs-and-esm-bundles">Shipping CJS and ESM bundles</a></li><li><a href="#tsconfig-for-the-tests">tsconfig for the tests</a></li><li><a href="#root-tsconfigjson">Root <code>tsconfig.json</code></a></li></ul></li><li><a href="#api-guidelines">API guidelines</a></li><li><a href="#commit-messages">Commit Messages</a></li><li><a href="#writing-documentation">Writing Documentation</a></li><li><a href="#adding-new-dependencies">Adding New Dependencies</a></li><li><a href="#running--writing-tests">Running &amp; Writing Tests</a></li><li><a href="#public-api-coverage">Public API Coverage</a></li><li><a href="#debugging-puppeteer">Debugging Puppeteer</a></li></ul></li><li><a href="#for-project-maintainers">For Project Maintainers</a><ul><li><a href="#rolling-new-chromium-version">Rolling new Chromium version</a><ul><li><a href="#bisecting-upstream-changes">Bisecting upstream changes</a></li></ul></li><li><a href="#releasing-to-npm">Releasing to npm</a></li></ul></li></ul><h1><a aria-hidden="true" tabindex="-1" class="anchor" id="how-to-contribute"></a>How to Contribute<a class="hash-link" href="#how-to-contribute" title="Direct link to heading">#</a></h1><p>First of all, thank you for your interest in Puppeteer!
We&#x27;d love to accept your patches and contributions!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="contributor-license-agreement"></a>Contributor License Agreement<a class="hash-link" href="#contributor-license-agreement" title="Direct link to heading">#</a></h2><p>Contributions to this project must be accompanied by a Contributor License
Agreement. You (or your employer) retain the copyright to your contribution,
this simply gives us permission to use and redistribute your contributions as
part of the project. Head over to <a href="https://cla.developers.google.com/" target="_blank" rel="noopener noreferrer">https://cla.developers.google.com/</a> to see
your current agreements on file or to sign a new one.</p><p>You generally only need to submit a CLA once, so if you&#x27;ve already submitted one
(even if it was for a different project), you probably don&#x27;t need to do it
again.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="getting-code"></a>Getting Code<a class="hash-link" href="#getting-code" title="Direct link to heading">#</a></h2><ol><li>Clone this repository</li></ol><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> clone https://github.com/puppeteer/puppeteer</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> puppeteer</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ol start="2"><li>Install dependencies</li></ol><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">install</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ol start="3"><li>Run Puppeteer tests locally. For more information about tests, read <a href="#running--writing-tests">Running &amp; Writing Tests</a>.</li></ol><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> run unit</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="code-reviews"></a>Code reviews<a class="hash-link" href="#code-reviews" title="Direct link to heading">#</a></h2><p>All submissions, including submissions by project members, require review. We
use GitHub pull requests for this purpose. Consult
<a href="https://help.github.com/articles/about-pull-requests/" target="_blank" rel="noopener noreferrer">GitHub Help</a> for more
information on using pull requests.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="code-style"></a>Code Style<a class="hash-link" href="#code-style" title="Direct link to heading">#</a></h2><ul><li>Coding style is fully defined in <a href="https://github.com/puppeteer/puppeteer/blob/main/.eslintrc.js" target="_blank" rel="noopener noreferrer"><code>.eslintrc</code></a> and we automatically format our code with <a href="https://prettier.io" target="_blank" rel="noopener noreferrer">Prettier</a>.</li><li>It&#x27;s recommended to set-up Prettier into your editor, or you can run <code>npm run eslint-fix</code> to automatically format any files.</li><li>If you&#x27;re working in a JS file, code should be annotated with <a href="https://github.com/google/closure-compiler/wiki/Annotating-JavaScript-for-the-Closure-Compiler" target="_blank" rel="noopener noreferrer">closure annotations</a>.</li><li>If you&#x27;re working in a TS file, you should explicitly type all variables and return types. You&#x27;ll get ESLint warnings if you don&#x27;t so if you&#x27;re not sure use them as guidelines, and feel free to ask us for help!</li></ul><p>To run ESLint, use:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> run eslint</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>You can check your code (both JS &amp; TS) type-checks by running:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> run tsc</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="typescript-guidelines"></a>TypeScript guidelines<a class="hash-link" href="#typescript-guidelines" title="Direct link to heading">#</a></h2><ul><li>Try to avoid the use of <code>any</code> when possible. Consider <code>unknown</code> as a better alternative. You are able to use <code>any</code> if needbe, but it will generate an ESLint warning.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="project-structure-and-typescript-compilation"></a>Project structure and TypeScript compilation<a class="hash-link" href="#project-structure-and-typescript-compilation" title="Direct link to heading">#</a></h2><p>The code in Puppeteer is split primarily into two folders:</p><ul><li><code>src</code> contains all source code</li><li><code>vendor</code> contains all dependencies that we&#x27;ve vendored into the codebase. See the (<a href="https://github.com/puppeteer/puppeteer/blob/main/vendor/README.md" target="_blank" rel="noopener noreferrer">https://github.com/puppeteer/puppeteer/blob/main/vendor/README.md</a>) for details.</li></ul><p>We structure these using TypeScript&#x27;s project references, which lets us treat each folder like a standalone TypeScript project.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="shipping-cjs-and-esm-bundles"></a>Shipping CJS and ESM bundles<a class="hash-link" href="#shipping-cjs-and-esm-bundles" title="Direct link to heading">#</a></h3><p>Currently Puppeteer ships two bundles; a CommonJS version for Node and an ESM bundle for the browser. Therefore we maintain two <code>tsconfig</code> files for each project; <code>tsconfig.esm.json</code> and <code>tsconfig.cjs.json</code>. At build time we compile twice, once outputting to CJS and another time to output to ESM.</p><p>We compile into the <code>lib</code> directory which is what we publish on the npm repository and it&#x27;s structured like so:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">lib</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">- cjs</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  - puppeteer &lt;== the output of compiling `src/tsconfig.cjs.json`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  - vendor &lt;== the output of compiling `vendor/tsconfig.cjs.json`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">- esm</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  - puppeteer &lt;== the output of compiling `src/tsconfig.esm.json`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  - vendor &lt;== the output of compiling `vendor/tsconfig.esm.json`</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The main entry point for the Node module Puppeteer is <code>cjs-entry.js</code>. This imports <code>lib/cjs/puppeteer/index.js</code> and exposes it to Node users.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="tsconfig-for-the-tests"></a>tsconfig for the tests<a class="hash-link" href="#tsconfig-for-the-tests" title="Direct link to heading">#</a></h3><p>We also maintain <code>test/tsconfig.test.json</code>. This is <strong>only used to compile the unit test <code>*.spec.ts</code> files</strong>. When the tests are run, we first compile Puppeteer as normal before running the unit tests <strong>against the compiled output</strong>. Doing this lets the test run against the compiled code we ship to users so it gives us more confidence in our compiled output being correct.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="root-tsconfigjson"></a>Root <code>tsconfig.json</code><a class="hash-link" href="#root-tsconfigjson" title="Direct link to heading">#</a></h3><p>The root <code>tsconfig.json</code> exists for the API Extractor; it has to find a <code>tsconfig.json</code> in the project&#x27;s root directory. It is <em>not</em> used for anything else.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="api-guidelines"></a>API guidelines<a class="hash-link" href="#api-guidelines" title="Direct link to heading">#</a></h2><p>When authoring new API methods, consider the following:</p><ul><li>Expose as little information as needed. When in doubt, don’t expose new information.</li><li>Methods are used in favor of getters/setters.<ul><li>The only exception is namespaces, e.g. <code>page.keyboard</code> and <code>page.coverage</code></li></ul></li><li>All string literals must be small case. This includes event names and option values.</li><li>Avoid adding &quot;sugar&quot; API (API that is trivially implementable in user-space) unless they&#x27;re <strong>very</strong> demanded.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="commit-messages"></a>Commit Messages<a class="hash-link" href="#commit-messages" title="Direct link to heading">#</a></h2><p>Commit messages should follow <a href="https://www.conventionalcommits.org/en/v1.0.0/#summary" target="_blank" rel="noopener noreferrer">the Conventional Commits format</a>. This is enforced via <code>npm run lint</code>.</p><p>In particular, breaking changes should clearly be noted as “BREAKING CHANGE:” in the commit message footer. Example:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">fix(page): fix page.pizza method</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">This patch fixes page.pizza so that it works with iframes.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Issues: #123, #234</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">BREAKING CHANGE: page.pizza now delivers pizza at home by default.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">To deliver to a different location, use the &quot;deliver&quot; option:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  `page.pizza({deliver: &#x27;work&#x27;})`.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="writing-documentation"></a>Writing Documentation<a class="hash-link" href="#writing-documentation" title="Direct link to heading">#</a></h2><p>All public API should have a descriptive entry in <a href="https://github.com/puppeteer/puppeteer/blob/main/docs/api.md" target="_blank" rel="noopener noreferrer"><code>docs/api.md</code></a>. There&#x27;s a <a href="https://github.com/puppeteer/puppeteer/tree/main/utils/doclint" target="_blank" rel="noopener noreferrer">documentation linter</a> which makes sure documentation is aligned with the codebase.</p><p>To run the documentation linter, use:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> run doc</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>To format the documentation markdown and its code snippets, use:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> run markdownlint-fix</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="adding-new-dependencies"></a>Adding New Dependencies<a class="hash-link" href="#adding-new-dependencies" title="Direct link to heading">#</a></h2><p>For all dependencies (both installation and development):</p><ul><li><strong>Do not add</strong> a dependency if the desired functionality is easily implementable.</li><li>If adding a dependency, it should be well-maintained and trustworthy.</li></ul><p>A barrier for introducing new installation dependencies is especially high:</p><ul><li><strong>Do not add</strong> installation dependency unless it&#x27;s critical to project success.</li></ul><p>There are additional considerations for dependencies that are environment agonistic. See the (<a href="https://github.com/puppeteer/puppeteer/blob/main/vendor/README.md" target="_blank" rel="noopener noreferrer">https://github.com/puppeteer/puppeteer/blob/main/vendor/README.md</a>) for details.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="running--writing-tests"></a>Running &amp; Writing Tests<a class="hash-link" href="#running--writing-tests" title="Direct link to heading">#</a></h2><ul><li>Every feature should be accompanied by a test.</li><li>Every public api event/method should be accompanied by a test.</li><li>Tests should not depend on external services.</li><li>Tests should work on all three platforms: Mac, Linux and Win. This is especially important for screenshot tests.</li></ul><p>Puppeteer tests are located in <a href="https://github.com/puppeteer/puppeteer/blob/main/test/" target="_blank" rel="noopener noreferrer">the <code>test</code> directory</a> and are written using Mocha. See (<a href="https://github.com/puppeteer/puppeteer/blob/main/test/README.md" target="_blank" rel="noopener noreferrer">https://github.com/puppeteer/puppeteer/blob/main/test/README.md</a>) for more details.</p><p>Despite being named &#x27;unit&#x27;, these are integration tests, making sure public API methods and events work as expected.</p><ul><li>To run all tests:</li></ul><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> run unit</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ul><li>To run a specific test, substitute the <code>it</code> with <code>it.only</code>:</li></ul><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-js codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token spread operator" style="color:rgb(137, 221, 255)">...</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  it</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">only</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;should work&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">async</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token parameter">server</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> page</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> response </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> page</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">goto</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">server</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">EMPTY_PAGE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">expect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">ok</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">toBe</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ul><li>To disable a specific test, substitute the <code>it</code> with <code>xit</code> (mnemonic rule: &#x27;<em>cross it</em>&#x27;):</li></ul><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-js codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token spread operator" style="color:rgb(137, 221, 255)">...</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Using &quot;xit&quot; to skip specific test</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">xit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;should work&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">async</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token parameter">server</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> page</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> response </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> page</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">goto</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">server</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">EMPTY_PAGE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">expect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">ok</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">toBe</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ul><li>To run tests in non-headless mode:</li></ul><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token assign-left variable" style="color:rgb(191, 199, 213)">HEADLESS</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">false </span><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> run unit</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ul><li>To run Firefox tests, firstly ensure you have Firefox installed locally (you only need to do this once, not on every test run) and then you can run the tests:</li></ul><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token assign-left variable" style="color:rgb(191, 199, 213)">PUPPETEER_PRODUCT</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">firefox node install.js</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">PUPPETEER_PRODUCT</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">firefox </span><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> run unit</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ul><li>To run tests with custom browser executable:</li></ul><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token assign-left variable" style="color:rgb(191, 199, 213)">BINARY</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">path-to-executable</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> run unit</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="public-api-coverage"></a>Public API Coverage<a class="hash-link" href="#public-api-coverage" title="Direct link to heading">#</a></h2><p>Every public API method or event should be called at least once in tests. To ensure this, there&#x27;s a <code>coverage</code> command which tracks calls to public API and reports back if some methods/events were not called.</p><p>Run coverage:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> run coverage</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="debugging-puppeteer"></a>Debugging Puppeteer<a class="hash-link" href="#debugging-puppeteer" title="Direct link to heading">#</a></h2><h1><a aria-hidden="true" tabindex="-1" class="anchor" id="for-project-maintainers"></a>For Project Maintainers<a class="hash-link" href="#for-project-maintainers" title="Direct link to heading">#</a></h1><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="rolling-new-chromium-version"></a>Rolling new Chromium version<a class="hash-link" href="#rolling-new-chromium-version" title="Direct link to heading">#</a></h2><p>The following steps are needed to update the Chromium version.</p><ol><li>Find a suitable Chromium revision
Not all revisions have builds for all platforms, so we need to find one that does.
To do so, run <code>utils/check_availability.js -rd</code> to find the latest suitable <code>dev</code> Chromium revision (see <code>utils/check_availability.js -help</code> for more options).</li><li>Update <code>src/revisions.ts</code> with the found revision number.</li><li>Update <code>versions.js</code> with the new Chromium-to-Puppeteer version mapping.</li><li>Run <code>npm run ensure-correct-devtools-protocol-revision</code>.
If it fails, update <code>package.json</code> with the expected <code>devtools-protocol</code> version.</li><li>Run <code>npm run tsc</code> and <code>npm install</code>.</li><li>Run <code>npm run unit</code> and ensure that all tests pass. If a test fails, <a href="#bisecting-upstream-changes">bisect</a> the upstream cause of the failure, and either update the test expectations accordingly (if it was an intended change) or work around the changes in Puppeteer (if it’s not desirable to change Puppeteer’s observable behavior).</li><li>Commit and push your changes and open a pull request.
The commit message must contain the version in <code>Chromium &lt;version&gt; (&lt;revision&gt;)</code> format to ensure that <a href="https://pptr.dev/" target="_blank" rel="noopener noreferrer">pptr.dev</a> can parse it correctly, e.g. <code>&#x27;feat(chromium): roll to Chromium 90.0.4427.0 (r856583)&#x27;</code>.</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="bisecting-upstream-changes"></a>Bisecting upstream changes<a class="hash-link" href="#bisecting-upstream-changes" title="Direct link to heading">#</a></h3><p>Sometimes, performing a Chromium roll causes tests to fail. To figure out the cause, you need to bisect Chromium revisions to figure out the earliest possible revision that changed the behavior. The script in <code>utils/bisect.js</code> can be helpful here. Given a Node.js script that calls <code>process.exit(1)</code> for bad revisions, run this from the Puppeteer repository’s root directory:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-sh codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">node utils/bisect.js --good 686378 --bad 706915 script.js</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="releasing-to-npm"></a>Releasing to npm<a class="hash-link" href="#releasing-to-npm" title="Direct link to heading">#</a></h2><p>Releasing to npm consists of the following phases:</p><ol><li>Source Code: mark a release.<ol><li>Run <code>npm run release</code>. (This automatically bumps the version number in <code>package.json</code>, populates the changelog, updates the docs, and creates a Git commit for the next step.)</li><li>Send a PR for the commit created in the previous step.</li><li>Make sure the PR passes <strong>all checks</strong>.<ul><li><strong>WHY</strong>: there are linters in place that help to avoid unnecessary errors, e.g. <a href="https://github.com/puppeteer/puppeteer/pull/2446" target="_blank" rel="noopener noreferrer">like this</a></li></ul></li><li>Merge the PR.</li><li>Once merged, publish the release notes from <code>CHANGELOG.md</code> using <a href="https://github.com/puppeteer/puppeteer/releases/new" target="_blank" rel="noopener noreferrer">GitHub’s “draft new release tag” option</a>.<ul><li><strong>NOTE</strong>: tag names are prefixed with <code>&#x27;v&#x27;</code>, e.g. for version <code>1.4.0</code> the tag is <code>v1.4.0</code>.</li></ul></li><li>As soon as the Git tag is created by completing the previous step, our CI automatically <code>npm publish</code>es the new releases for both the <code>puppeteer</code> and <code>puppeteer-core</code> packages.</li></ol></li><li>Source Code: mark post-release.<ol><li>Bump <code>package.json</code> version to the <code>-post</code> version, run <code>npm run doc</code> to update the “released APIs” section at the top of <code>docs/api.md</code> accordingly, and send a PR titled <code>&#x27;chore: bump version to vXXX.YYY.ZZZ-post&#x27;</code> (<a href="https://github.com/puppeteer/puppeteer/pull/6808" target="_blank" rel="noopener noreferrer">example</a>)<ul><li><strong>NOTE</strong>: no other commits should be landed in-between release commit and bump commit.</li></ul></li></ol></li></ol></section></article><div></div></main><div class="col col--2"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#contributor-license-agreement" class="table-of-contents__link">Contributor License Agreement</a></li><li><a href="#getting-code" class="table-of-contents__link">Getting Code</a></li><li><a href="#code-reviews" class="table-of-contents__link">Code reviews</a></li><li><a href="#code-style" class="table-of-contents__link">Code Style</a></li><li><a href="#typescript-guidelines" class="table-of-contents__link">TypeScript guidelines</a></li><li><a href="#project-structure-and-typescript-compilation" class="table-of-contents__link">Project structure and TypeScript compilation</a><ul><li><a href="#shipping-cjs-and-esm-bundles" class="table-of-contents__link">Shipping CJS and ESM bundles</a></li><li><a href="#tsconfig-for-the-tests" class="table-of-contents__link">tsconfig for the tests</a></li><li><a href="#root-tsconfigjson" class="table-of-contents__link">Root <code>tsconfig.json</code></a></li></ul></li><li><a href="#api-guidelines" class="table-of-contents__link">API guidelines</a></li><li><a href="#commit-messages" class="table-of-contents__link">Commit Messages</a></li><li><a href="#writing-documentation" class="table-of-contents__link">Writing Documentation</a></li><li><a href="#adding-new-dependencies" class="table-of-contents__link">Adding New Dependencies</a></li><li><a href="#running--writing-tests" class="table-of-contents__link">Running &amp; Writing Tests</a></li><li><a href="#public-api-coverage" class="table-of-contents__link">Public API Coverage</a></li><li><a href="#debugging-puppeteer" class="table-of-contents__link">Debugging Puppeteer</a></li><li><a href="#rolling-new-chromium-version" class="table-of-contents__link">Rolling new Chromium version</a><ul><li><a href="#bisecting-upstream-changes" class="table-of-contents__link">Bisecting upstream changes</a></li></ul></li><li><a href="#releasing-to-npm" class="table-of-contents__link">Releasing to npm</a></li></ul></div></div></div></div></div></div>
<script src="/testing2/styles.1b2702fc.js"></script>
<script src="/testing2/runtime~main.d62fd070.js"></script>
<script src="/testing2/main.49fc4005.js"></script>
<script src="/testing2/1.39323fe6.js"></script>
<script src="/testing2/2.bd80ada8.js"></script>
<script src="/testing2/3.4c2ec1ad.js"></script>
<script src="/testing2/ccc49370.c7adbee1.js"></script>
<script src="/testing2/704a48b3.b781fd51.js"></script>
<script src="/testing2/54f148e2.f5344aef.js"></script>
</body>
</html>